matrix:
  include:
  - language: android
    android:
      components:
        - build-tools-22.0.1
        - android-22
        - extra
        - addon
        - sys-img-armeabi-v7a-android-22
    before_install:
      - mkdir /home/travis/screenshots/
      - export PATH=$PATH:$JAVA_HOME/bin
      - export ANDROID_HOME=/usr/local/android-sdk/
      - nvm install 6
    before_script:
      - npm install -g appium
      - npm install -g appium-doctor
      - appium-doctor
      - echo no | android create avd --force -n testEmu2 -t android-22 --abi armeabi-v7a
      - emulator -avd testEmu2 -no-skin -no-audio -no-window &
      - android-wait-for-emulator
      - adb shell input keyevent 82 &
      - appium &
    script:
      - mvn clean test
      - ls /home/travis/screenshots/ -a
      - cp target/surefire-reports/emailable-report.html /home/travis/screenshots/
      - gzip -r /home/travis/screenshots/
    deploy:
      provider: releases
      api_key: "f9238b107e62ac92c3ba1fe620b800b49e9f4df7"
      file_glob: true
      file: "/home/travis/screenshots/*"
      skip_cleanup: true
      on:
        tags: true 
notifications:
  email:
    - gabriel@cbqasolutions.com
